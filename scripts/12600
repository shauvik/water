{"coscript-json-url":"coscript:http:\/\/coscripter.researchlabs.ibm.com\/coscripter\/api\/script\/12600","koalescence-lite-url":"http:\/\/coscripter.researchlabs.ibm.com\/coscripter\/lite\/script\/12600","coscripter-save-url":"http:\/\/coscripter.researchlabs.ibm.com\/coscripter\/api\/script\/12600","coscript-run-url":"coscriptrun:http:\/\/coscripter.researchlabs.ibm.com\/coscripter\/lite\/script\/12600","modified-at":"2008-10-07T13:18:14Z","creator":{"shortname":"lenart","name":"lenart","email":"lenart"},"coscript-run-json-url":"coscriptrun:http:\/\/coscripter.researchlabs.ibm.com\/coscripter\/api\/script\/12600","body":"* $fileIn = FileOpen(\"c:\\download\\filelist.txt\", 0)\n\n\n\n\n; Check if file opened for reading OK\n\n\nIf $fileIn = -1 Then\n\n\n    MsgBox(0, \"Error\", \"Unable to open file1.\")\n\n\n    Exit\n\n\nEndIf\n\n\n\n\n\n$fileOut = FileOpen(\"C:\\dowlnoad\\#download.iim\", 2)\n\n\n;$fileOut = FileOpen(\"c:\\Download\\fileout.txt\", 2)\n\n\n; Check if file opened for reading OK\n\n\nIf $fileOut = -1 Then\n\n\n    MsgBox(0, \"Error\", \"Unable to open file2.\")\n\n\n    Exit\n\n\nEndIf\n\n\n\n\n\n$fileLog = FileOpen(\"c:\\download\\log.txt\", 2)\n\n\n$fileErr = FileOpen(\"c:\\download\\err.txt\", 2)\n\n\n\n\n\n; Run IE\n\n\nRun(\"F:\\Program Files\\Internet Explorer\\iexplore.exe\")\n\n\nSleep(15000)\n\n\n\n\n\n; Go to address bar\n\n\nSend(\"^{TAB}\")\n\n\nSleep(2000)\n\n\n\n\n\n; Write macro header\n\n\nFileWriteLine($fileOut, \"VERSION BUILD=6060801 RECORDER=FX\")\n\n\nFileWriteLine($fileOut, \"TAB T=1\")\n\n\n\n\n\n; Process input file\n\n\nWhile 1\n\n\n\n\n\n    ; Read line\n\n\n\t$inputLine = FileReadLine($fileIn)\n\n\n\tIf @error = -1 Then ExitLoop\n\n\n\t\n\n\n\t; Strip white space\n\n\n\t$inputLine = StringStripWS($inputLine, 8)\n\n\n\t\n\n\n\t\t; Paste input line to address bar\n\n\n\t\tSend($inputLine)\n\n\n\t\tFileWriteLine($fileLog, \"Input: \" & $inputLine)\n\n\n\t\t\n\n\n\t\t; Commit\n\n\n\t\tSend(\"{ENTER}\")\n\n\n\t\tSleep(4000)\n\n\n\n\n\n\t\t; Go to button \"Free user\"\n\n\n\t\tSend(\"{TAB 13}\")\n\n\n\t\tSleep(2000)\n\n\n\t\t\n\n\n\t\t; Commit\n\n\n\t\tSend(\"{ENTER}\")\n\n\n\t\tSleep(4000)\n\n\n\t\t\n\n\n\t\t; Go to address bar\n\n\n\t\tSend(\"{TAB}\")\n\n\n\t\tSleep(2000)\n\n\n\t\t\n\n\n\t\t; Get url from address bar through clipboard\n\n\n\t\tSend(\"^c\")\n\n\n\t\tSleep(1000)\n\n\n\t\t$url1 = ClipGet()\n\n\n\t\t$url1 = StringStripWS($url1, 8)\n\n\n\t\tFileWriteLine($fileLog, \"Url1 line: \" & $url1)\n\n\n\t\n\n\n\t\t$n = StringInStr($url1, \"m\")\n\n\n\t\t$host = StringLeft($url1, $n)\n\n\n\t\t\n\n\n\tFileWriteLine($fileOut, \"URL GOTO=\" & $url1)\n\n\n\tFileWriteLine($fileOut, \"WAIT SECONDS=3\")\n\n\n\tFileWriteLine($fileOut, \"TAG POS=1 TYPE=INPUT:SUBMIT FORM=ACTION:\" & $url1 & \" ATTR=VALUE:Free<SP>user\")\n\n\n\tFileWriteLine($fileOut, \"WAIT SECONDS=80\")\n\n\n\tFileWriteLine($fileOut, \"TAG POS=1 TYPE=INPUT:IMAGE FORM=NAME:dlf ATTR=SRC:\" & $host & \"\/img2\/download_file.jpg\")\n\n\n\tFileWriteLine($fileOut, \"WAIT SECONDS=3\")\n\n\nWend\n\n\n\n\n\nFileClose($fileIn)\n\n\nFileClose($fileOut)\n\n\nFileClose($fileLog)\n\n\nFileClose($fileErr)\n\n\nMsgBox(0, \"End of Processing\", \"End of Processing\")\n\n\n\n\n\n\n\n\n\n","title":"(no title)","json-url":"http:\/\/coscripter.researchlabs.ibm.com\/coscripter\/api\/script\/12600","coscript-url":"coscript:http:\/\/coscripter.researchlabs.ibm.com\/coscripter\/lite\/script\/12600","private":false,"body-html":"<!-- (C) Copyright IBM Corp. 2010 -->\n<ul>\n\t<li>$fileIn = FileOpen(&#8220;c:\\download\\filelist.txt&#8221;, 0)<\/li>\n<\/ul>\n<p>; Check if file opened for reading OK<\/p>\n<p>If $fileIn = -1 Then<\/p>\nMsgBox(0, &#8220;Error&#8221;, &#8220;Unable to open file1.&#8221;)\nExit\n<p>EndIf<\/p>\n<p>$fileOut = FileOpen(&#8220;C:\\dowlnoad\\#download.iim&#8221;, 2)<\/p>\n<p>;$fileOut = FileOpen(&#8220;c:\\Download\\fileout.txt&#8221;, 2)<\/p>\n<p>; Check if file opened for reading OK<\/p>\n<p>If $fileOut = -1 Then<\/p>\nMsgBox(0, &#8220;Error&#8221;, &#8220;Unable to open file2.&#8221;)\nExit\n<p>EndIf<\/p>\n<p>$fileLog = FileOpen(&#8220;c:\\download\\log.txt&#8221;, 2)<\/p>\n<p>$fileErr = FileOpen(&#8220;c:\\download\\err.txt&#8221;, 2)<\/p>\n<p>; Run IE<\/p>\n<p>Run(&#8220;F:\\Program Files\\Internet Explorer\\iexplore.exe&#8221;)<\/p>\n<p>Sleep(15000)<\/p>\n<p>; Go to address bar<\/p>\n<p>Send(&#8220;^{TAB}&#8221;)<\/p>\n<p>Sleep(2000)<\/p>\n<p>; Write macro header<\/p>\n<p>FileWriteLine($fileOut, &#8220;<span class=\"caps\">VERSION<\/span> <span class=\"caps\">BUILD<\/span>=6060801 <span class=\"caps\">RECORDER<\/span>=FX&#8221;)<\/p>\n<p>FileWriteLine($fileOut, &#8220;<span class=\"caps\">TAB<\/span> T=1&#8221;)<\/p>\n<p>; Process input file<\/p>\n<p>While 1<\/p>\n; Read line\n<p>$inputLine = FileReadLine($fileIn)<\/p>\n<p>If @error = -1 Then ExitLoop<\/p>\n<p><\/p>\n<p>; Strip white space<\/p>\n<p>$inputLine = StringStripWS($inputLine, 8)<\/p>\n<p><\/p>\n<p>; Paste input line to address bar<\/p>\n<p>Send($inputLine)<\/p>\n<p>FileWriteLine($fileLog, &quot;Input: &quot; &amp; $inputLine)<\/p>\n<p><\/p>\n<p>; Commit<\/p>\n<p>Send(&#8220;{ENTER}&#8221;)<\/p>\n<p>Sleep(4000)<\/p>\n<p>; Go to button &#8220;Free user&#8221;<\/p>\n<p>Send(&#8220;{TAB 13}&#8221;)<\/p>\n<p>Sleep(2000)<\/p>\n<p><\/p>\n<p>; Commit<\/p>\n<p>Send(&#8220;{ENTER}&#8221;)<\/p>\n<p>Sleep(4000)<\/p>\n<p><\/p>\n<p>; Go to address bar<\/p>\n<p>Send(&#8220;{TAB}&#8221;)<\/p>\n<p>Sleep(2000)<\/p>\n<p><\/p>\n<p>; Get url from address bar through clipboard<\/p>\n<p>Send(&#8220;^c&#8221;)<\/p>\n<p>Sleep(1000)<\/p>\n<p>$url1 = ClipGet()<\/p>\n<p>$url1 = StringStripWS($url1, 8)<\/p>\n<p>FileWriteLine($fileLog, &quot;Url1 line: &quot; &amp; $url1)<\/p>\n<p><\/p>\n<p>$n = StringInStr($url1, &#8220;m&#8221;)<\/p>\n<p>$host = StringLeft($url1, $n)<\/p>\n<p><\/p>\n<p>FileWriteLine($fileOut, &#8220;<span class=\"caps\">URL<\/span> <span class=\"caps\">GOTO<\/span>=&#8221; &amp; $url1)<\/p>\n<p>FileWriteLine($fileOut, &#8220;<span class=\"caps\">WAIT<\/span> <span class=\"caps\">SECONDS<\/span>=3&#8221;)<\/p>\n<p>FileWriteLine($fileOut, &#8220;<span class=\"caps\">TAG<\/span> <span class=\"caps\">POS<\/span>=1 <span class=\"caps\">TYPE<\/span>=<span class=\"caps\">INPUT<\/span>:<span class=\"caps\">SUBMIT<\/span> <span class=\"caps\">FORM<\/span>=<span class=\"caps\">ACTION<\/span>:&#8221; &amp; $url1 &amp; &quot; <span class=\"caps\">ATTR<\/span>=<span class=\"caps\">VALUE<\/span>:Free<SP>user&quot;)<\/p>\n<p>FileWriteLine($fileOut, &#8220;<span class=\"caps\">WAIT<\/span> <span class=\"caps\">SECONDS<\/span>=80&#8221;)<\/p>\n<p>FileWriteLine($fileOut, &#8220;<span class=\"caps\">TAG<\/span> <span class=\"caps\">POS<\/span>=1 <span class=\"caps\">TYPE<\/span>=<span class=\"caps\">INPUT<\/span>:<span class=\"caps\">IMAGE<\/span> <span class=\"caps\">FORM<\/span>=<span class=\"caps\">NAME<\/span>:dlf <span class=\"caps\">ATTR<\/span>=<span class=\"caps\">SRC<\/span>:&#8221; &amp; $host &amp; &#8220;\/img2\/download_file.jpg&#8221;)<\/p>\n<p>FileWriteLine($fileOut, &#8220;<span class=\"caps\">WAIT<\/span> <span class=\"caps\">SECONDS<\/span>=3&#8221;)<\/p>\n<p>Wend<\/p>\n<p>FileClose($fileIn)<\/p>\n<p>FileClose($fileOut)<\/p>\n<p>FileClose($fileLog)<\/p>\n<p>FileClose($fileErr)<\/p>\n<p>MsgBox(0, &#8220;End of Processing&#8221;, &#8220;End of Processing&#8221;)<\/p>\n","coscripter-wiki-url":"http:\/\/coscripter.researchlabs.ibm.com\/coscripter\/browse\/script\/12600","id":12600,"koalescence-url":"http:\/\/coscripter.researchlabs.ibm.com\/coscripter\/browse\/script\/12600","coscripter-executed-url":"http:\/\/coscripter.researchlabs.ibm.com\/coscripter\/api\/executed","coscripter-url":"http:\/\/coscripter.researchlabs.ibm.com\/coscripter\/lite\/script\/12600"}